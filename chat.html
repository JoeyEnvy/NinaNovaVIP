<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Leave Nina a message ğŸ¤</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <!-- SEO -->
  <meta name="description" content="A quiet, private place to leave Nina a message. No pressure. No rush.">
  <link rel="canonical" href="https://ninanovatv.com/chat.html">

  <!-- Open Graph -->
  <meta property="og:title" content="Leave Nina a message">
  <meta property="og:description" content="A quieter place to talk. Nina reads messages when she can.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://ninanovatv.com/chat.html">

  <link rel="icon" href="images/download.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="images/download.svg">

  <link rel="stylesheet" href="styles.css">
</head>

<body class="has-bg">

<header class="nav">
  <div class="nav-inner">
    <a href="index.html" class="brand" data-track="home">
      Nina<span>Nova</span><em>TV</em>
    </a>

    <div class="location location-strong" id="nina-location">
      ğŸ“ Ninaâ€™s around somewhereâ€¦
    </div>

    <a href="custom.html" class="btn ghost nav-cta" data-track="custom">
      Custom Nina
    </a>

    <button class="hamburger" id="hamburger" aria-label="Menu">
      <span></span><span></span><span></span>
    </button>
  </div>

  <nav class="mobile-menu" id="mobileMenu">
    <a href="chat.html" data-track="chat">ğŸ¤ Leave me a note</a>
    <a href="custom.html" data-track="custom">ğŸ¥ Something personal</a>
    <a href="https://www.fanvue.com/nina_nova" target="_blank" rel="noopener" data-track="fanvue">ğŸŒ™ Fanvue</a>
    <a href="https://t.me/NinaUnfilteredNova" target="_blank" rel="noopener" data-track="telegram">â˜• Telegram</a>
  </nav>
</header>

<main>
<section class="hero contact-hero">
  <div style="max-width:720px;margin:0 auto;">

    <h1>Leave me a message ğŸ¤</h1>

    <p>I donâ€™t really like loud inboxes or public comment sections. This is just a quieter place.</p>
    <p>I canâ€™t promise instant replies â€” but I do read everything here.</p>

    <div class="chat-box" style="margin-top:30px;">
      <div class="chat-header">
        <span>Nina</span>
        <small>private messages</small>
      </div>

      <div id="chat-messages">
        <div class="msg nina">hey ğŸ¤ you can leave me a message here</div>
      </div>

      <div class="chat-input">
        <input id="chat-input" type="text" placeholder="Write your messageâ€¦" autocomplete="off" />
        <button id="chat-send" data-track="send">Send</button>
      </div>
    </div>

    <p style="margin-top:14px;font-size:.8rem;opacity:.6;font-style:italic;">
      Replies arenâ€™t instant. Thatâ€™s kind of the point.
    </p>

    <div class="links" style="margin-top:36px;">
      <a href="https://t.me/NinaUnfilteredNova" target="_blank" rel="noopener" data-track="telegram">
        â˜• Telegram <small>If you prefer quicker replies</small>
      </a>

      <a href="index.html" data-track="home">
        â† Back to the quiet corner <small>Take your time</small>
      </a>
    </div>

  </div>
</section>
</main>

<footer class="footer">
  <p>Thanks for being patient ğŸ¤<br><small>Some things are nicer unhurried</small></p>
</footer>

<script>
document.addEventListener("DOMContentLoaded", () => {

  /* =========================
     CONFIG
  ========================= */
  const TRACK_URL = "https://ninanovavip-backend.onrender.com/track";
  const API_URL   = "https://ninanovavip-backend.onrender.com/grok";

  /* =========================
     ANALYTICS (SAFE)
  ========================= */
  function track(payload) {
    try {
      if (navigator.sendBeacon) {
        navigator.sendBeacon(TRACK_URL, JSON.stringify(payload));
      } else {
        fetch(TRACK_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload),
          keepalive: true
        });
      }
    } catch {}
  }

  track({ type: "pageview", page: "chat" });

  document.querySelectorAll("[data-track]").forEach(el => {
    el.addEventListener("click", () => {
      track({ type: "click", page: "chat", target: el.dataset.track });
    });
  });

  /* =========================
     HAMBURGER
  ========================= */
  const ham = document.getElementById("hamburger");
  const menu = document.getElementById("mobileMenu");
  if (ham && menu) {
    ham.addEventListener("click", () => {
      menu.classList.toggle("open");
      ham.classList.toggle("active");
    });
  }

  /* =========================
     CHAT ELEMENTS
  ========================= */
  const chatBox = document.getElementById("chat-messages");
  const input   = document.getElementById("chat-input");
  const sendBtn = document.getElementById("chat-send");

  if (!chatBox || !input || !sendBtn) {
    console.error("Chat elements missing");
    return;
  }

  /* =========================
     SESSION
  ========================= */
  let sessionId = localStorage.getItem("nina_session");
  if (!sessionId) {
    sessionId = crypto.randomUUID();
    localStorage.setItem("nina_session", sessionId);
  }

  /* =========================
     UI HELPERS
  ========================= */
  function addMessage(text, who) {
    const div = document.createElement("div");
    div.className = `msg ${who}`;
    div.textContent = text;
    chatBox.appendChild(div);
    chatBox.scrollTop = chatBox.scrollHeight;
  }

  function addTyping() {
    const div = document.createElement("div");
    div.className = "msg nina";
    div.id = "typing";
    div.textContent = "â€¦";
    chatBox.appendChild(div);
  }

  function removeTyping() {
    const t = document.getElementById("typing");
    if (t) t.remove();
  }

  /* =========================
     SEND MESSAGE
  ========================= */
  async function sendMessage() {
    const text = input.value.trim();
    if (!text) return;

    addMessage(text, "user");
    input.value = "";
    addTyping();

    track({ type: "message", page: "chat" });

    try {
      const res = await fetch(API_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ text, sessionId, source: "site" })
      });

      const data = await res.json();

      setTimeout(() => {
        removeTyping();
        addMessage(data.grok_reply || "i saw this ğŸ¤", "nina");
      }, 1200 + Math.random() * 2200);

    } catch {
      removeTyping();
      addMessage("sorry â€” i missed that ğŸ¤", "nina");
    }
  }

  /* =========================
     EVENTS
  ========================= */
  sendBtn.addEventListener("click", sendMessage);

  input.addEventListener("keydown", e => {
    if (e.key === "Enter") {
      e.preventDefault();
      sendMessage();
    }
  });

});
</script>


</body>
</html>
